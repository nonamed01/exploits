// Exercice 2
// Build:
//  gcc -Wl,-z,relro,-z,now,--build-id=0xdeadbeefcafebabe -no-pie -fno-stack-protector ex2.c -O0 -o ex2
// Goal:    set RAX to 0x3b by re-purposing a function within the binary
// Exploit: ex2-exploit.py
#include <stdio.h>
#include <unistd.h>
#include <string.h>

unsigned char _xor(unsigned char, unsigned char);

int main (int argc, char **argv){

    char data[100];

    // We zero-out data[]:
    memset(&data,0,100);
    // BOF; returning from main is under our control:
    gets(data);
    return 0;
}

unsigned char _xor(unsigned char a, unsigned char b){
    return a^b;
}

__asm__("pop %rdi;ret;");
__asm__("pop %rsi;ret;");
