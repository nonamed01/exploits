// Exercice 1
// Build:
//  gcc -Wl,-z,relro,-z,now,--build-id=0xdeadbeefcafebabe -no-pie -fno-stack-protector ex1.c -o ex1
// Goal:    set RAX to 0x3b   
// Exploit: ex1-exploit.py
#include <stdio.h>
#include <unistd.h>
#include <string.h>

const char *mydata;

int main(int argc, char **argv){

    char data[100];

    // We zero-out data[]:
    memset(&data,0,100);
    // BOF; returning from main is under our control:
    gets(data);
    // Writes up to 20 bytes to stdout:
    write(1,data,20);

    return 0;
}

__asm__("pop %rdi;ret;");
__asm__("pop %rsi;ret;");
__asm__("pop %rdx;ret;");
